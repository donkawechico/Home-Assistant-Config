  - platform: yr
  - platform: mqtt
    state_topic: "stat/sensor/door/POWER"
    name: "Front Door"
    value_template: >
      {% if value=='OFF' %}
        CLOSED
      {% else %}
        OPEN
      {% endif %}
  - platform: mqtt
    state_topic: "hass/light/kitchen/strip"
    name: "MQTT Kitchen Strip"
  - platform: darksky
    api_key: !secret darksky_api_key
    name: weather
    latitude: !secret zone_home_lat
    longitude: !secret zone_home_long
    monitored_conditions:
      - summary
      - icon
      - nearest_storm_distance
  - platform: command_line
    name: SSL cert expiry
    unit_of_measurement: days
    scan_interval: 10800
    command: "ssl-cert-check -b -c /etc/letsencrypt/live/dk.servebeer.com/cert.pem | awk '{ print $NF }'"
  - platform: template
    sensors:
      donnie_home:
        friendly_name: "Donnie is at home"
        value_template: >-
          {% 
            if  is_state('person.donnie', 'home') or
                is_state('input_boolean.donnie_home', 'on')
          %} 
          home
          {% else %}
          not_home
          {% endif %}
      christine_home:
        friendly_name: "Christine is at home"
        value_template: >-
          {% if is_state('person.christine', 'home') %} 
            home
          {% else %}
            not_home
          {% endif %}
      camera_privacy_mode:
        friendly_name: "Camera Privacy Mode"
        value_template: >
          {% if is_state('input_select.privacy_mode', 'No Cameras') or
                is_state('input_select.privacy_mode', 'Total Privacy') %}
            Locked
          {% else %}
            Open
          {% endif %}
#      temperature_feels_like_livingroom:
#        friendly_name: 'Livingroom Feels Like'
#        #formula taken from http://www.srh.noaa.gov/ama/?n=heatindex
#        value_template: '{{ ((-42.379 + (2.04901523 * (states.sensor.multisensor_livingroom_temperature.state|float)) + (10.14333127 * (states.sensor.multisensor_livingroom_relative_humidity.state|float)) - (0.22475541 * (states.sensor.multisensor_livingroom_temperature.state|float) * (states.sensor.multisensor_livingroom_relative_humidity.state|float)) - (6.83783 * 10**(-3) * (states.sensor.multisensor_livingroom_temperature.state|float)**2) - (5.481717 * 10**-2 * (states.sensor.multisensor_livingroom_relative_humidity.state|float)**2 )+ (1.22874 * 10**-3 * (states.sensor.multisensor_livingroom_temperature.state|float)**2 * (states.sensor.multisensor_livingroom_relative_humidity.state|float)) + (8.5282*10**-4 * (states.sensor.multisensor_livingroom_temperature.state|float) * (states.sensor.multisensor_livingroom_relative_humidity.state|float)**2) - (1.99 * 10**-6 * (states.sensor.multisensor_livingroom_temperature.state|float)**2 * (states.sensor.multisensor_livingroom_relative_humidity.state|float)**2))|round(2)) }}'
#        unit_of_measurement: '째F'
      dew_point_livingroom:
        friendly_name: 'Livingroom Dew Point'
        value_template: '{{ states.sensor.multisensor_livingroom_temperature.state | float - (9/25) * (100 - states.sensor.multisensor_livingroom_relative_humidity.state | round(2)) }}'
        unit_of_measurement: '째F'
#      temperature_feels_like_bedroom:
#        friendly_name: 'Bedroom Feels Like'
#        #formula taken from http://www.srh.noaa.gov/ama/?n=heatindex
#        value_template: '{{ ((-42.379 + (2.04901523 * (states.sensor.multisensor_bedroom_temperature.state|float)) + (10.14333127 * (states.sensor.multisensor_bedroom_relative_humidity.state|float)) - (0.22475541 * (states.sensor.multisensor_bedroom_temperature.state|float) * (states.sensor.multisensor_bedroom_relative_humidity.state|float)) - (6.83783 * 10**(-3) * (states.sensor.multisensor_bedroom_temperature.state|float)**2) - (5.481717 * 10**-2 * (states.sensor.multisensor_bedroom_relative_humidity.state|float)**2 )+ (1.22874 * 10**-3 * (states.sensor.multisensor_bedroom_temperature.state|float)**2 * (states.sensor.multisensor_bedroom_relative_humidity.state|float)) + (8.5282*10**-4 * (states.sensor.multisensor_bedroom_temperature.state|float) * (states.sensor.multisensor_bedroom_relative_humidity.state|float)**2) - (1.99 * 10**-6 * (states.sensor.multisensor_bedroom_temperature.state|float)**2 * (states.sensor.multisensor_bedroom_relative_humidity.state|float)**2))|round(2)) }}'
#        unit_of_measurement: '째F'
      dew_point_bedroom:
        friendly_name: 'Bedroom Dew Point'
        value_template: '{{ states.sensor.multisensor_bedroom_temperature.state | float - (9/25) * (100 - states.sensor.multisensor_bedroom_relative_humidity.state | round(2)) }}'
        unit_of_measurement: '째F'
      relevant_dew_point:
        friendly_name: 'Dew Point measurement to use for climate control'
        value_template: >
          {% if is_state('input_select.climate_room', 'Bedroom') %}
            {{ states.sensor.dew_point_bedroom.state | round(2)}}
          {% elif is_state('input_select.climate_room', 'Livingroom') %}
            {{ states.sensor.dew_point_livingroom.state | round(2) }}
          {% else %}
            {{ states.sensor.dew_point_livingroom.state | round(2) }}
          {% endif %}
  - platform: time_date
    display_options:
      - 'time'
      - 'date'
      - 'date_time'
  # - platform: spotcast
